<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Newton Forest Adventure</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Luckiest+Guy&display=swap');

body {
    margin: 0;
    text-align: center;
    font-family: 'Luckiest Guy', cursive;
    background: #0d1f0d;
    overflow: hidden;
    touch-action: none;
    height: 100vh;
    display: flex;
    flex-direction: column;
}

canvas {
    display: block;
    margin: 0;
    width: 100vw;
    flex-grow: 1;
    background: #1a3c1a;
}

/* TOP BUTTONS */
.top-btn {
    position: fixed;
    width: 35px;
    height: 35px;
    border: 2px solid #ffe066;
    border-radius: 50%;
    color: white;
    font-size: 16px;
    z-index: 2000;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
}

#skinBtn { top:10px; right:100px; background:#7b1fa2; }
#bgSwitchBtn { top:10px; right:55px; background:#2E7D32; }
#muteBtn { top:10px; right:10px; background:#1565c0; }

#startOverlay {
    position: fixed;
    width:100vw;height:100vh;
    background:url('background.png') center/cover no-repeat;
    display:flex;flex-direction:column;
    align-items:center;justify-content:center;
    z-index:1000;
}

.main-btn {
    font-size:32px;
    padding:15px 50px;
    border-radius:50px;
    border:4px solid #ffe066;
    color:white;
    background:#2E7D32;
}

/* MOBILE CONTROLS */
#mobile-ui {
    background:#000;
    padding:10px;
}

#control-lane {
    display:flex;
    justify-content:space-around;
}

#leftBtn,#rightBtn {
    width:85px;height:85px;
    border-radius:50%;
    font-size:40px;
}
</style>
</head>

<body>

<div id="skinBtn" class="top-btn">üëï</div>
<div id="bgSwitchBtn" class="top-btn">üñºÔ∏è</div>
<div id="muteBtn" class="top-btn">üîä</div>

<div id="startOverlay">
    <h1>NEWTON GRAVITY</h1>
    <button id="playBtn" class="main-btn">PLAY START</button>
</div>

<canvas id="game" width="1000" height="500"></canvas>

<div id="mobile-ui">
    <div id="control-lane">
        <button id="leftBtn">‚óÄ</button>
        <button id="pauseBtn">PAUSE</button>
        <button id="rightBtn">‚ñ∂</button>
    </div>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

/* ‚úÖ DEVICE DETECTION (ONLY ONCE ‚Äî FIXED) */
const isMobile = ('ontouchstart' in window) || navigator.maxTouchPoints > 0;

/* ‚úÖ Hide mobile controls on laptop */
if (!isMobile) {
    document.getElementById("mobile-ui").style.display = "none";
}

/* GAME VARIABLES */
let newtonX = 425;
let score = 0;
let isPaused = false;

const keys = { left:false, right:false };

const L_LIMIT = 20;
const R_LIMIT = 980;

/* ‚úÖ KEYBOARD CONTROLS FOR LAPTOP */
if (!isMobile) {
    window.addEventListener("keydown", (e)=>{
        if(e.code==="ArrowLeft"||e.code==="KeyA") keys.left=true;
        if(e.code==="ArrowRight"||e.code==="KeyD") keys.right=true;
        if(e.code==="Space") togglePause();
    });

    window.addEventListener("keyup",(e)=>{
        if(e.code==="ArrowLeft"||e.code==="KeyA") keys.left=false;
        if(e.code==="ArrowRight"||e.code==="KeyD") keys.right=false;
    });
}

/* MOBILE TOUCH CONTROLS */
function bindMove(btn, key){
    const el=document.getElementById(btn);
    if(!isMobile) return;

    el.addEventListener("touchstart",(e)=>{e.preventDefault();keys[key]=true;});
    el.addEventListener("touchend",(e)=>{e.preventDefault();keys[key]=false;});
}
bindMove("leftBtn","left");
bindMove("rightBtn","right");

/* START BUTTON WORKS FOR BOTH */
document.getElementById("playBtn").addEventListener("click",startGame);

/* GAME LOOP */
function startGame(){
    document.getElementById("startOverlay").style.display="none";
    gameLoop();
}

function togglePause(){
    isPaused=!isPaused;
    if(!isPaused) gameLoop();
}

function update(){
    if(keys.left && newtonX>L_LIMIT) newtonX-=10;
    if(keys.right && newtonX<R_LIMIT-100) newtonX+=10;
}

function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="orange";
    ctx.fillRect(newtonX,400,120,80);
}

function gameLoop(){
    if(isPaused) return;
    update();
    draw();
    requestAnimationFrame(gameLoop);
}
</script>
</body>
</html>
